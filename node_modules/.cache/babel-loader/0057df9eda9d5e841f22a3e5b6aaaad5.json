{"ast":null,"code":"const authUtil = {\n  isAuthenticated: () => {\n    let expiresAt = JSON.parse(localStorage.getItem(\"expiresAt\"));\n    return new Date().getTime() < expiresAt;\n  },\n  logout: () => {\n    localStorage.removeItem(\"access_token\");\n    localStorage.removeItem(\"expiresAt\");\n    window.location = `${process.env.REACT_APP_UAA_PROTOCOL}://${process.env.REACT_APP_UAA_BASE_URL}${process.env.REACT_APP_UAA_PORT}/uaa/logout.do?redirect=http://${process.env.REACT_APP_REPORT_BACKEND_FE_BASE_URL}${process.env.REACT_APP_REPORT_BACKEND_FE_PORT}/login&client_id=app`;\n  },\n  isRedirectedBackFromAuthServer: location => {\n    return location.hash;\n  },\n  isAuthorizedByAuthServer: location => {\n    let params = new URLSearchParams(location.hash.substr(1));\n    const state = params.get(\"state\");\n    const accessToken = params.get(\"access_token\");\n    const expiresAt = params.get(\"expires_in\") * 1000 + new Date().getTime();\n    return accessToken && expiresAt && state && state == localStorage.getItem(\"stateStr\");\n  },\n  persistAuthCredential: location => {\n    let params = new URLSearchParams(location.hash.substr(1));\n    const accessToken = params.get(\"access_token\");\n    const expiresAt = params.get(\"expires_in\") * 1000 + new Date().getTime();\n    localStorage.setItem(\"access_token\", accessToken);\n    localStorage.setItem(\"expiresAt\", expiresAt);\n  },\n  redirectToPreLocation: () => {\n    const preLocation = JSON.parse(localStorage.getItem(\"previousLocation\"));\n    localStorage.removeItem(\"previousLocation\");\n    window.location = `${preLocation.pathname}`;\n  },\n  redirectToLoginErrorPage: () => {\n    window.location = \"/loginfailed\";\n  },\n  redirectToAuthServer: location => {\n    localStorage.setItem(\"previousLocation\", JSON.stringify(location));\n    const stateStr = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n    localStorage.setItem(\"stateStr\", stateStr);\n    window.location = `${process.env.REACT_APP_UAA_PROTOCOL}://${process.env.REACT_APP_UAA_BASE_URL}${process.env.REACT_APP_UAA_PORT}/uaa/oauth/authorize?client_id=app&response_type=token&state=${stateStr}&redirect_uri=http://${process.env.REACT_APP_REPORT_BACKEND_FE_BASE_URL}${process.env.REACT_APP_REPORT_BACKEND_FE_PORT}/login`;\n  },\n  parseJwt: token => {\n    var base64Url = token.split('.')[1];\n    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n    var jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\n      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n    return JSON.parse(jsonPayload);\n  }\n};\nexport default authUtil;","map":{"version":3,"sources":["/home/dev-04/parvan/reactProjects/geomanagement2-fe/src/service/authUtil.js"],"names":["authUtil","isAuthenticated","expiresAt","JSON","parse","localStorage","getItem","Date","getTime","logout","removeItem","window","location","process","env","REACT_APP_UAA_PROTOCOL","REACT_APP_UAA_BASE_URL","REACT_APP_UAA_PORT","REACT_APP_REPORT_BACKEND_FE_BASE_URL","REACT_APP_REPORT_BACKEND_FE_PORT","isRedirectedBackFromAuthServer","hash","isAuthorizedByAuthServer","params","URLSearchParams","substr","state","get","accessToken","persistAuthCredential","setItem","redirectToPreLocation","preLocation","pathname","redirectToLoginErrorPage","redirectToAuthServer","stringify","stateStr","Math","random","toString","substring","parseJwt","token","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","slice","join"],"mappings":"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","sourcesContent":["\n\nconst authUtil = {\n    isAuthenticated: () => {\n        let expiresAt = JSON.parse(localStorage.getItem(\"expiresAt\"));\n        return new Date().getTime() < expiresAt;\n    },\n    logout: () => {\n        localStorage.removeItem(\"access_token\");\n        localStorage.removeItem(\"expiresAt\");\n        window.location = `${process.env.REACT_APP_UAA_PROTOCOL}://${process.env.REACT_APP_UAA_BASE_URL}${process.env.REACT_APP_UAA_PORT}/uaa/logout.do?redirect=http://${process.env.REACT_APP_REPORT_BACKEND_FE_BASE_URL}${process.env.REACT_APP_REPORT_BACKEND_FE_PORT}/login&client_id=app`\n    },\n    isRedirectedBackFromAuthServer: (location) => {\n        return location.hash;\n    },\n\n    isAuthorizedByAuthServer: (location) => {\n        let params = new URLSearchParams(location.hash.substr(1));\n        const state = params.get(\"state\");\n        const accessToken = params.get(\"access_token\");\n        const expiresAt = params.get(\"expires_in\") * 1000 + new Date().getTime();\n\n        return accessToken && expiresAt && state && state == localStorage.getItem(\"stateStr\");\n    },\n\n    persistAuthCredential: (location) => {\n        let params = new URLSearchParams(location.hash.substr(1));\n        const accessToken = params.get(\"access_token\");\n        const expiresAt = params.get(\"expires_in\") * 1000 + new Date().getTime();\n        localStorage.setItem(\"access_token\", accessToken);\n        localStorage.setItem(\"expiresAt\", expiresAt);\n    },\n\n    redirectToPreLocation: () => {\n        const preLocation = JSON.parse(localStorage.getItem(\"previousLocation\"));\n        localStorage.removeItem(\"previousLocation\");\n        window.location = `${preLocation.pathname}`;\n    },\n\n    redirectToLoginErrorPage: () => {\n        window.location = \"/loginfailed\";\n    },\n\n    redirectToAuthServer: (location) => {\n        localStorage.setItem(\"previousLocation\", JSON.stringify(location));\n        const stateStr = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n        localStorage.setItem(\"stateStr\", stateStr);\n\n        window.location = `${process.env.REACT_APP_UAA_PROTOCOL}://${process.env.REACT_APP_UAA_BASE_URL}${process.env.REACT_APP_UAA_PORT}/uaa/oauth/authorize?client_id=app&response_type=token&state=${stateStr}&redirect_uri=http://${process.env.REACT_APP_REPORT_BACKEND_FE_BASE_URL}${process.env.REACT_APP_REPORT_BACKEND_FE_PORT}/login`;\n    },\n\n    parseJwt: (token) => {\n        var base64Url = token.split('.')[1];\n        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n        var jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        }).join(''));\n        return JSON.parse(jsonPayload);\n    }\n}\n\n\nexport default authUtil;"]},"metadata":{},"sourceType":"module"}